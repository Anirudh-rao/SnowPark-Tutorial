SELECT current_warehouse();

CREATE OR REPLACE WAREHOUSE who1
    WAREHOUSE_TYPE = 'SNOWPARK-OPTIMIZED'       -- not 'STANDARD' (by def)
    WAREHOUSE_SIZE = 'MEDIUM'                   -- not 'XSMALL'/'SMALL' (XSMALL by def)
    RESOURCE_CONSTRAINT = 'MEMORY_16X_X86'      -- 'MEMORY_1/16/64X[_x86]' (16X by def)
    MAX_CONCURRENCY_LEVEL = 1                   -- for best CPU+RAM resource utilization (by def 8)
    AUTO_RESUME = TRUE
    AUTO_SUSPEND = 60                           -- by def 10 minutes!
    INITIALLY_SUSPENDED = TRUE                  -- by def FALSE!
    STATEMENT_TIMEOUT_IN_SECONDS = 240;         -- 4h, instead of 2 days!)

SHOW WAREHOUSES;

ALTER WAREHOUSE who1 RESUME;

USE WAREHOUSE who1;

ALTER WAREHOUSE who1 SET WAREHOUSE_TYPE = STANDARD;

ALTER WAREHOUSE who1 SET WAREHOUSE_SIZE = 'X-SMALL';

ALTER WAREHOUSE who1 SET WAREHOUSE_TYPE = 'SNOWPARK-OPTIMIZED';

ALTER WAREHOUSE who1 SUSPEND;

ALTER WAREHOUSE who1 SET WAREHOUSE_TYPE = 'SNOWPARK-OPTIMIZED';

ALTER WAREHOUSE who1 SET WAREHOUSE_SIZE = LARGE;

ALTER WAREHOUSE who1 SET WAREHOUSE_TYPE = 'SNOWPARK-OPTIMIZED';

SHOW WAREHOUSES;

USE WAREHOUSE compute_wh;

DROP WAREHOUSE who1;
